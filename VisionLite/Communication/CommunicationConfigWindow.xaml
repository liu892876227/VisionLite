<!--Communication/CommunicationConfigWindow.xaml-->
<!--新建通讯连接配置窗口 - 提供协议选择和参数配置的用户界面-->
<Window x:Class="VisionLite.Communication.CommunicationConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="新建通讯连接" Height="600" Width="500"
        WindowStartupLocation="CenterOwner" ShowInTaskbar="False"
        ResizeMode="CanResize" MinHeight="400" MinWidth="400">
    
    <!-- 窗口样式 -->
    <Window.Resources>
        <!-- 标题样式 -->
        <Style x:Key="TitleTextStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        
        <!-- 分组框样式 -->
        <Style x:Key="ConfigGroupStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="0,5,0,10"/>
            <Setter Property="Padding" Value="10"/>
        </Style>
        
        <!-- 标签样式 -->
        <Style x:Key="ParameterLabelStyle" TargetType="Label">
            <Setter Property="Width" Value="100"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,2,10,2"/>
        </Style>
        
        <!-- 按钮样式 -->
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="80"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        
        <!-- 必需参数标记样式 -->
        <Style x:Key="RequiredMarkStyle" TargetType="TextBlock">
            <Setter Property="Text" Value=" *"/>
            <Setter Property="Foreground" Value="Red"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- 基本信息区域 -->
            <RowDefinition Height="*"/>      <!-- 动态参数区域 -->
            <RowDefinition Height="Auto"/>   <!-- 预设模板区域 -->
            <RowDefinition Height="Auto"/>   <!-- 操作按钮区域 -->
        </Grid.RowDefinitions>

        <!-- 基本信息配置区域 -->
        <GroupBox Grid.Row="0" Header="基本信息" Style="{StaticResource ConfigGroupStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- 连接名称 -->
                <Label Grid.Row="0" Grid.Column="0" Content="连接名称:" 
                       Style="{StaticResource ParameterLabelStyle}"/>
                <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                    <TextBox x:Name="ConnectionNameTextBox" Width="200" 
                             ToolTip="为连接指定一个唯一的名称"
                             TextChanged="ConnectionNameTextBox_TextChanged"/>
                    <TextBlock Style="{StaticResource RequiredMarkStyle}"/>
                </StackPanel>

                <!-- 协议类型 -->
                <Label Grid.Row="1" Grid.Column="0" Content="协议类型:" 
                       Style="{StaticResource ParameterLabelStyle}"/>
                <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal">
                    <ComboBox x:Name="ProtocolComboBox" Width="200"
                              DisplayMemberPath="DisplayName"
                              SelectionChanged="ProtocolComboBox_SelectionChanged"
                              ToolTip="选择通讯协议类型"/>
                    <TextBlock Style="{StaticResource RequiredMarkStyle}"/>
                </StackPanel>

                <!-- 协议描述 -->
                <Label Grid.Row="2" Grid.Column="0" Content="协议描述:" 
                       Style="{StaticResource ParameterLabelStyle}"/>
                <TextBlock x:Name="ProtocolDescriptionText" Grid.Row="2" Grid.Column="1"
                           TextWrapping="Wrap" Margin="0,5,0,5" 
                           Foreground="Gray" FontStyle="Italic"
                           Text="请选择协议类型以查看详细描述"/>
            </Grid>
        </GroupBox>

        <!-- 动态参数配置区域 -->
        <GroupBox Grid.Row="1" Header="协议参数" x:Name="ParameterGroupBox" 
                  Style="{StaticResource ConfigGroupStyle}">
            <ScrollViewer VerticalScrollBarVisibility="Auto" 
                          HorizontalScrollBarVisibility="Auto">
                <StackPanel x:Name="DynamicParameterPanel" Margin="5">
                    <!-- 动态生成的参数控件将添加到这里 -->
                    <TextBlock Text="请选择协议类型以配置相关参数" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               Foreground="Gray" FontStyle="Italic"
                               x:Name="EmptyParameterHint"/>
                </StackPanel>
            </ScrollViewer>
        </GroupBox>

        <!-- 配置模板区域 -->
        <GroupBox Grid.Row="2" Header="快速配置模板" x:Name="TemplateGroupBox"
                  Style="{StaticResource ConfigGroupStyle}" Visibility="Collapsed">
            <StackPanel>
                <TextBlock Text="选择预定义的配置模板快速设置参数：" 
                           Margin="0,0,0,5" FontSize="12"/>
                <ComboBox x:Name="ConfigTemplateComboBox" 
                          DisplayMemberPath="Name"
                          SelectionChanged="ConfigTemplateComboBox_SelectionChanged"
                          ToolTip="选择配置模板自动填充参数"/>
                <TextBlock x:Name="TemplateDescriptionText" 
                           TextWrapping="Wrap" Margin="0,5,0,0" 
                           FontSize="11" Foreground="Gray" FontStyle="Italic"/>
            </StackPanel>
        </GroupBox>

        <!-- 操作按钮区域 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" 
                    HorizontalAlignment="Right" Margin="0,10,0,0">
            
            <!-- 测试连接按钮 -->
            <Button x:Name="TestConnectionButton" Content="测试连接" 
                    Style="{StaticResource ActionButtonStyle}"
                    Click="TestConnection_Click" 
                    ToolTip="测试当前配置是否能正常连接"
                    IsEnabled="False"/>
            
            <!-- 重置按钮 -->
            <Button x:Name="ResetButton" Content="重置" 
                    Style="{StaticResource ActionButtonStyle}"
                    Click="Reset_Click" 
                    ToolTip="重置所有参数到默认值"/>
            
            <!-- 确定按钮 -->
            <Button x:Name="OKButton" Content="确定" 
                    Style="{StaticResource ActionButtonStyle}"
                    Click="OK_Click" IsDefault="True" 
                    ToolTip="保存配置并创建连接"
                    IsEnabled="False"/>
            
            <!-- 取消按钮 -->
            <Button x:Name="CancelButton" Content="取消" 
                    Style="{StaticResource ActionButtonStyle}"
                    Click="Cancel_Click" IsCancel="True" 
                    ToolTip="取消操作并关闭窗口"/>
        </StackPanel>
    </Grid>
    
    <!-- 状态栏（可选） -->
    <!--<StatusBar DockPanel.Dock="Bottom">
        <StatusBarItem>
            <TextBlock x:Name="StatusText" Text="请配置连接参数"/>
        </StatusBarItem>
    </StatusBar>-->
    
</Window>